<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>CODŒûX ‚Äî Season 2 Prelude</title>
<style>
:root {
  --gold: #ffd700;
  --yellow: #ffeb3b;
  --blue: #0066ff;
  --darkblue: #001a4d;
  --accent: #00d4ff;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}

@keyframes pulse {
  0%, 100% { opacity: 0.4; }
  50% { opacity: 0.8; }
}

@keyframes glow {
  0%, 100% { box-shadow: 0 0 40px rgba(255,235,59,0.3), 0 0 80px rgba(0,102,255,0.2); }
  50% { box-shadow: 0 0 60px rgba(255,235,59,0.5), 0 0 120px rgba(0,102,255,0.3); }
}

@keyframes slideIn {
  from { transform: translateX(-100%); opacity: 0; }
  to { transform: translateX(0); opacity: 1; }
}

@keyframes zoomIn {
  from { transform: scale(0.8); opacity: 0; }
  to { transform: scale(1); opacity: 1; }
}

* { box-sizing: border-box; margin: 0; padding: 0; }
html, body { height: 100%; }
body {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
  background: radial-gradient(ellipse at top, #001a4d, #000814);
  color: #fff;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 20px;
  overflow: hidden;
  position: relative;
}

body::before {
  content: '';
  position: absolute;
  inset: 0;
  background: 
    radial-gradient(circle at 20% 30%, rgba(255,235,59,0.15) 0%, transparent 50%),
    radial-gradient(circle at 80% 70%, rgba(0,102,255,0.15) 0%, transparent 50%);
  animation: pulse 3s ease-in-out infinite;
  pointer-events: none;
}

.stage {
  text-align: center;
  width: 100%;
  max-width: 800px;
  position: relative;
  z-index: 1;
}

/* Cutscene overlay */
#cutscene {
  position: fixed;
  inset: 0;
  background: linear-gradient(135deg, rgba(0,26,77,0.95), rgba(0,8,20,0.95));
  display: none;
  justify-content: center;
  align-items: center;
  z-index: 100;
  animation: fadeIn 0.5s ease-out;
}

#cutsceneContent {
  max-width: 700px;
  padding: 40px;
  text-align: center;
}

#cutsceneText {
  font-size: 1.8rem;
  font-weight: 700;
  background: linear-gradient(135deg, var(--yellow), var(--accent));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin-bottom: 30px;
  animation: zoomIn 0.8s ease-out;
  line-height: 1.5;
  text-shadow: 0 0 40px rgba(255,235,59,0.3);
}

#cutsceneImage {
  width: 80%;
  max-width: 500px;
  border-radius: 20px;
  animation: zoomIn 1s ease-out 0.3s both;
  box-shadow: 0 0 60px rgba(255,235,59,0.4), 0 0 120px rgba(0,102,255,0.3);
}

#dialogue {
  margin: 0 auto 40px;
  min-height: 60px;
  max-width: 600px;
  background: linear-gradient(135deg, rgba(255,235,59,0.05), rgba(0,102,255,0.05));
  backdrop-filter: blur(10px);
  padding: 20px 30px;
  border-radius: 16px;
  border: 1px solid rgba(255,235,59,0.2);
  font-weight: 500;
  line-height: 1.6;
  font-size: 1.1rem;
  letter-spacing: 0.3px;
  animation: fadeIn 0.6s ease-out;
  transition: all 0.3s ease;
  box-shadow: 0 4px 20px rgba(255,235,59,0.1);
}

#codex {
  width: 50%;
  max-width: 600px;
  min-width: 200px;
  border-radius: 20px;
  filter: blur(35px);
  transition: filter 1.5s cubic-bezier(0.4, 0, 0.2, 1), transform 0.6s ease;
  animation: fadeIn 1s ease-out 0.3s both, glow 3s ease-in-out infinite;
  margin-bottom: 40px;
}

#codex:hover {
  transform: scale(1.02);
}

/* Progress Bar */
#progressWrap {
  width: 100%;
  max-width: 400px;
  height: 4px;
  background: rgba(255,255,255,0.1);
  border-radius: 999px;
  margin: 0 auto 12px;
  overflow: hidden;
  animation: fadeIn 0.8s ease-out 0.5s both;
}

#progressBar {
  height: 100%;
  width: 0%;
  background: linear-gradient(90deg, var(--yellow), var(--blue), var(--accent));
  transition: width 1s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 0 20px rgba(255,235,59,0.6);
}

#percent {
  font-size: 0.9rem;
  color: rgba(255,235,59,0.7);
  font-weight: 400;
  letter-spacing: 1px;
  margin-bottom: 30px;
  animation: fadeIn 0.8s ease-out 0.6s both;
}

/* Buttons */
.buttons {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  justify-content: center;
  animation: fadeIn 0.8s ease-out 0.7s both;
}

.button {
  padding: 12px 24px;
  border-radius: 999px;
  background: linear-gradient(135deg, rgba(255,235,59,0.08), rgba(0,102,255,0.08));
  backdrop-filter: blur(10px);
  color: rgba(255,255,255,0.9);
  border: 1px solid rgba(255,235,59,0.2);
  font-weight: 500;
  text-decoration: none;
  cursor: pointer;
  font-size: 0.9rem;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  display: inline-flex;
  align-items: center;
  gap: 6px;
}

.button:hover {
  background: linear-gradient(135deg, rgba(255,235,59,0.15), rgba(0,102,255,0.15));
  border-color: rgba(255,235,59,0.4);
  color: var(--yellow);
  transform: translateY(-2px);
  box-shadow: 0 8px 25px rgba(255,235,59,0.3);
}

.button:active {
  transform: translateY(0);
}

/* Popup modal */
#popup {
  position: fixed;
  inset: 0;
  background: rgba(0,8,20,0.9);
  backdrop-filter: blur(8px);
  display: none;
  justify-content: center;
  align-items: center;
  padding: 20px;
  z-index: 99;
  animation: fadeIn 0.3s ease-out;
}

#popupContent {
  background: linear-gradient(135deg, rgba(0,26,77,0.95), rgba(0,8,20,0.95));
  backdrop-filter: blur(20px);
  border-radius: 20px;
  max-width: 600px;
  padding: 40px;
  box-shadow: 0 20px 60px rgba(0,0,0,0.5);
  border: 1px solid rgba(255,235,59,0.2);
  animation: fadeIn 0.4s ease-out;
}

#popup h2 {
  background: linear-gradient(135deg, var(--yellow), var(--accent));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin-bottom: 20px;
  font-size: 1.8rem;
  font-weight: 600;
}

#popup p {
  font-size: 1rem;
  line-height: 1.8;
  margin-bottom: 16px;
  color: rgba(255,255,255,0.85);
  font-weight: 300;
}

#popup strong {
  color: var(--accent);
  font-weight: 500;
}

#closePopup {
  margin-top: 20px;
  background: linear-gradient(135deg, rgba(0,102,255,0.15), rgba(0,212,255,0.15));
  color: var(--accent);
  border-color: rgba(0,212,255,0.3);
}

@media (max-width: 600px) {
  #codex { width: 70%; filter: blur(40px); }
  #dialogue { font-size: 1rem; padding: 16px 20px; }
  #cutsceneText { font-size: 1.4rem; }
  .buttons { gap: 8px; }
  .button { padding: 10px 18px; font-size: 0.85rem; }
  #popupContent { padding: 30px 24px; }
}
</style>
</head>

<body>
  <!-- Cutscene Overlay -->
  <div id="cutscene">
    <div id="cutsceneContent">
      <div id="cutsceneText"></div>
      <img id="cutsceneImage" src="assets/images/codex-blurred.jpg" alt="Codex">
    </div>
  </div>

  <main class="stage">
    <div id="dialogue">[static crackle] Initializing...</div>
    <img id="codex" src="assets/images/codex-blurred.jpg" alt="Codex Logo">
    <div id="progressWrap"><div id="progressBar"></div></div>
    <div id="percent">0%</div>

    <div class="buttons">
      <button id="skipBtn" class="button">‚è≠ Skip</button>
      <button id="moreBtn" class="button">üìñ Lore</button>
      <a href="https://youtube.com/playlist?list=PLuHsYM1bT174ZiVwEPvgpFl1poTaHjCRD"
         target="_blank" class="button">‚ñ∂ Season 1</a>
      <a href="https://youtube.com/@weeklyofficial_2025"
         target="_blank" class="button">üåÄ XX Weekly</a>
      <a href="https://youtube.com/@binifn.x"
         target="_blank" class="button">üî• BiniFn</a>
    </div>
  </main>

  <audio id="bg" src="assets/audio/hero-ending.mp3" loop preload="auto"></audio>

  <!-- Popup -->
  <div id="popup">
    <div id="popupContent">
      <h2>üìò Codex: The LEGO Fortnite Chronicles</h2>
      <p><strong>Season 1 Recap:</strong> After the Storm King shattered the LEGO Hub,
      fragments of the Codex scattered across biomes ‚Äî frozen peaks, brick deserts,
      and the shadowed dungeons beneath the Spire.</p>
      <p>Adventurers forged alliances to rebuild the Codex ‚Äî but its energy
      fused with Storm Essence, creating something neither side could control.</p>
      <p><strong>Now:</strong> In Season 2, the Codex begins to reassemble itself,
      layer by layer. As the blur fades, so does the boundary between worlds.
      The storm returns... but this time, it answers to no one.</p>
      <p>Every reveal day brings new fragments online. Check back until November 22
      to witness the full awakening of the Codex.</p>
      <button id="closePopup" class="button">Close</button>
    </div>
  </div>

<script>
const dialogue = [
  "BiniFn: Whoa ‚Äî we're back online! ‚ö°",
  "XX Weekly: You didn't think Season 1 was the end, did you? üòè",
  "BiniFn: After that explosion in the LEGO Fortnite hub?? üí•",
  "XX Weekly: The Codex wasn't destroyed ‚Äî it evolved.",
  "BiniFn: So this is Season 2? üëÄ",
  "XX Weekly: Not exactly. This is the bridge between worlds.",
  "BiniFn: The Codex logo‚Ä¶ it's re-forming?! üåÄ",
  "XX Weekly: Layer by layer, until November 22. Patience builds power. üí´",
  "BiniFn: (grins) So the cliffhanger finally pays off.",
  "XX Weekly: Indeed. The storm returns ‚Äî and this time, it listens to the Codex. üå©",
  "BiniFn: Let's make history, agents. System reboot in 3‚Ä¶2‚Ä¶1‚Ä¶ üöÄ"
];

const dlg = document.getElementById('dialogue');
const codex = document.getElementById('codex');
const progressBar = document.getElementById('progressBar');
const percent = document.getElementById('percent');
const bg = document.getElementById('bg');
const cutscene = document.getElementById('cutscene');
const cutsceneText = document.getElementById('cutsceneText');

let idx = 0, timer = null, revealTimer = null;

/* ---- Audio ---- */
async function playMusic(){
  try { await bg.play(); }
  catch(e){
    document.body.addEventListener('click', ()=>bg.play(), {once:true});
  }
}

/* ---- Cutscene ---- */
function showCutscene(){
  cutsceneText.textContent = "The Codex logo‚Ä¶ it's re-forming?! üåÄ";
  cutscene.style.display = 'flex';
  setTimeout(() => {
    cutscene.style.display = 'none';
  }, 3500);
}

/* ---- Dialogue ---- */
function nextLine(){
  if(idx >= dialogue.length){ startReveal(); return; }
  
  // Show cutscene at line 6 (the re-forming line)
  if(idx === 6) {
    showCutscene();
  }
  
  dlg.style.animation = 'none';
  setTimeout(() => {
    dlg.textContent = dialogue[idx++];
    dlg.style.animation = 'fadeIn 0.6s ease-out';
  }, 50);
  timer = setTimeout(nextLine, 1800);
}

function startDialogue(){
  dlg.textContent = dialogue[idx];
  timer = setTimeout(nextLine, 1600);
  playMusic();
}

/* ---- Skip ---- */
document.getElementById('skipBtn').onclick = ()=>{
  clearTimeout(timer);
  dlg.textContent = "Dialogue skipped. Beginning reveal...";
  startReveal();
};

/* ---- Reveal logic ---- */
const START = new Date(2025,10,19,0,0,0);
const END = new Date(2025,10,22,0,0,0);
const MAX_BLUR = 35;

function getProgress(){
  const now = new Date();
  if(now <= START) return 0;
  if(now >= END) return 100;
  const total = END - START;
  return Math.floor(((now - START) / total) * 100);
}

function updateProgress(){
  const pct = getProgress();
  progressBar.style.width = pct + "%";
  percent.textContent = pct + "%";
  const blur = MAX_BLUR * (1 - pct/100);
  codex.style.filter = `blur(${blur.toFixed(1)}px)`;
  if(pct >= 100){
    dlg.textContent = "Codex fully revealed ‚Äî The Tempest awakens. ‚ö°";
    clearInterval(revealTimer);
    codex.style.transform = "scale(1.05)";
    setTimeout(()=> codex.style.transform = "scale(1)", 1000);
  }
}

function startReveal(){
  clearInterval(revealTimer);
  updateProgress();
  revealTimer = setInterval(updateProgress, 60*1000);
}

/* ---- Popup ---- */
const popup = document.getElementById('popup');
document.getElementById('moreBtn').onclick = ()=> popup.style.display = 'flex';
document.getElementById('closePopup').onclick = ()=> popup.style.display = 'none';
popup.onclick = (e) => { if(e.target === popup) popup.style.display = 'none'; };

/* ---- Init ---- */
window.onload = ()=> setTimeout(startDialogue, 1500);
</script>
</body>
</html>